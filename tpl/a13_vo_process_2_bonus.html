{foreach key=k item=i from=$priz}
{assign var=x value=bonus`$k`}

<nobr>
<input type=checkbox id=bonus{$k}cb{$list_item.tp_kod}
onclick="
$('#bonus4cb{$list_item.tp_kod}').attr('disabled',
$('#bonus1cb{$list_item.tp_kod}').prop('checked')||
$('#bonus2cb{$list_item.tp_kod}').prop('checked')||
$('#bonus3cb{$list_item.tp_kod}').prop('checked')
?true:false);
$('#bonus{$k}cb_val_{$list_item.tp_kod}').attr('disabled',
$('#bonus{$k}cb{$list_item.tp_kod}').prop('checked')
?false:true);
$('#bonus{$k}cb_val_{$list_item.tp_kod}').val('');
$('#bonus{$k}_hidden_val_{$list_item.tp_kod}').val('');
"
{if $list_item.$x}checked{/if}
{if $list_item.bonus4}disabled{/if}
>
{$i}
<select required id=bonus{$k}cb_val_{$list_item.tp_kod} {if not $list_item.$x}disabled{/if} onchange="
(

parseInt($('#bonus1cb_val_{$list_item.tp_kod}').attr('disabled')?0:$('#bonus1cb_val_{$list_item.tp_kod}').val())+
parseInt($('#bonus2cb_val_{$list_item.tp_kod}').attr('disabled')?0:$('#bonus2cb_val_{$list_item.tp_kod}').val())+
parseInt($('#bonus3cb_val_{$list_item.tp_kod}').attr('disabled')?0:$('#bonus3cb_val_{$list_item.tp_kod}').val())

)>parseInt({$list_item.max_bonus})?this.value='':null;
$('#bonus{$k}_hidden_val_{$list_item.tp_kod}').val(this.value);
">
<option></option>{section name=foo start=1 loop=$list_item.max_bonus+1 step=1}<option value={$smarty.section.foo.index}>{$smarty.section.foo.index}</option>{/section}
</select>
<script>$('#bonus{$k}cb_val_{$list_item.tp_kod}').val({$list_item.$x})</script>
<input type=hidden id=bonus{$k}_hidden_val_{$list_item.tp_kod} value="{$list_item.$x}" name=data[{$list_item.tp_kod}][bonus{$k}]>
</nobr>
<br>

{/foreach}

<nobr>
<input type=checkbox id=bonus4cb{$list_item.tp_kod}
onclick="
$('#bonus1cb{$list_item.tp_kod}').attr('disabled',$('#bonus4cb{$list_item.tp_kod}').prop('checked')?true:false);
$('#bonus2cb{$list_item.tp_kod}').attr('disabled',$('#bonus4cb{$list_item.tp_kod}').prop('checked')?true:false);
$('#bonus3cb{$list_item.tp_kod}').attr('disabled',$('#bonus4cb{$list_item.tp_kod}').prop('checked')?true:false);
$('#bonus4cb_val_{$list_item.tp_kod}').attr('disabled',
$('#bonus4cb{$list_item.tp_kod}').prop('checked')
?false:true);
$('#bonus4cb_val_{$list_item.tp_kod}').val('');
$('#bonus4_hidden_val_{$list_item.tp_kod}').val('');
"
{if $list_item.bonus4}checked{/if}
{if
   $list_item.bonus1
or $list_item.bonus2
or $list_item.bonus3
}disabled{/if}
>
продукция
<input id=bonus4cb_val_{$list_item.tp_kod} {if not $list_item.bonus4}disabled{/if} size=5 onchange="$('#bonus4_hidden_val_{$list_item.tp_kod}').val(this.value)">
<script>$('#bonus4cb_val_{$list_item.tp_kod}').val({$list_item.bonus4})</script>
<input type=hidden id=bonus4_hidden_val_{$list_item.tp_kod} value="{$list_item.bonus4}" name=data[{$list_item.tp_kod}][bonus4]>
</nobr>
