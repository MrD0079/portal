{literal}
<!DOCTYPE html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
        width: 100%;
        margin: 0px;
        padding: 0px;
      }
    </style>
<script async defer src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initMap"></script>
<script>
String.prototype.nl2br = function()
{
    return this.replace(/\n/g, "<br />");
}
var map;
function initMap() {
  var mapOptions = {
    zoom: 0,
    center: new google.maps.LatLng(0, 0),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById('map'),
      mapOptions);
  var polyOptions = {
    strokeColor: '#000000',
    strokeOpacity: 1.0,
    strokeWeight: 3
  };
	poly = new google.maps.Polyline(polyOptions);
	poly.setMap(map);
	var path = poly.getPath();
	var latlngbounds = new google.maps.LatLngBounds();
window.googlemapdata = [
{/literal}
{foreach key=list_detail_key item=list_detail_item from=$list_detail name=list_detail}
{if
	$list_item.day eq $list_detail_item.day
	and $list_item.h_eta eq $list_detail_item.h_eta
	and $list_item.ts eq $list_detail_item.ts
	and $list_detail_item.latitude
	and $list_detail_item.longitude
}
{$list_detail_item.googledata}
{/if}
{/foreach}
{literal}
];
/**/
	var markers = [];
	var infowindow = new google.maps.InfoWindow();
	for (var i = 0; i < googlemapdata.length; i++) {
		var label = '';
		if (i==0)
		{
			label='S';
		}
		if (i==googlemapdata.length-1)
		{
			label='F';
		}
		path.push(googlemapdata[i].latlng);
		marker = new google.maps.Marker({
			position: googlemapdata[i].latlng,
			map: map,
			title: googlemapdata[i].name,
			label: label,
			//infoWindowSmall: new google.maps.InfoWindow({content: googlemapdata[i].num})
		});
		markers.push(marker);
		google.maps.event.addListener(marker, 'click', (function(marker, i) {
			return function() {
				infowindow.setContent(googlemapdata[i].name.nl2br());
				infowindow.open(map, marker);
			}
		})(marker, i));
		latlngbounds.extend(googlemapdata[i].latlng);
	}
	map.fitBounds(latlngbounds);
}
</script>
</head>
<body>
<div id="map"></div>
</body>
{/literal}
