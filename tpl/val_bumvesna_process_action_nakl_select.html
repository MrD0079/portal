<table border="1" cellspacing="0" cellpadding=3 width=1000px>
	<tr style="font-weight:bold;text-align:center">
		<td>№ п/п<br></td>
		<td>Дата накладной</td>
		<td>Номер накладной</td>
		<td>Сумма по накладной, {$valuta}</td>

		<td>Количество ящиков весовых конфет в накладной</td>
		<td>Сумма продаж весовых конфет, {$valuta}</td>
		<td>Сумма продаж весового печенья, {$valuta}</td>
		<td>Выполнено условие по весовым КОНФЕТАМ</td>
		<td>Выполнено условие по весовому ПЕЧЕНЬЮ</td>

		<td>Сумма бонуса, {$valuta}</td>
		<td>Дата выдачи бонуса</td>
	</tr>
	{foreach key=nakl_list_key item=nakl_list_item from=$nakl_list name=nakl_list}
	<tr {if $nakl_list_item.action_nakl eq 1}bgcolor="#00ff00"{/if} bgcolor="{cycle values="#ccffff,#ffffcc"}">
		<td>{$smarty.foreach.nakl_list.iteration}</td>
		<td>{$nakl_list_item.data}</td>
		<td>{$nakl_list_item.nakl}</td>
		<td style="text-align:right">{$nakl_list_item.summa|default:0|num:2}</td>

		<td style="text-align:right">{$nakl_list_item.packveskonf|default:0|num:0}</td>
		<td style="text-align:right">{$nakl_list_item.summshok|default:0|num:2}</td>
		<td style="text-align:right">{$nakl_list_item.summvespech|default:0|num:2}</td>

		<td {if $nakl_list_item.if1 eq 1}bgcolor="#00ff00"{/if} style="text-align:center">
			<input
				{if not $nakl_list_item.ok_traid neq 1 or $nakl_list_item.ok_chief eq 1}disabled{/if} {if $nakl_list_item.if1 neq 1} disabled {/if}
				onclick="
				$('#bonus_sum{$nakl_list_item.h_tp_kod_data_nakl}').attr('disabled',((!this.checked)&&(!($('#if2{$nakl_list_item.h_tp_kod_data_nakl}').val()==1)?true:false)));
				$('#bonus_dt{$nakl_list_item.h_tp_kod_data_nakl}').attr('disabled',((!this.checked)&&(!($('#if2{$nakl_list_item.h_tp_kod_data_nakl}').val()==1)?true:false)));
				$('#if1{$nakl_list_item.h_tp_kod_data_nakl}').val(this.checked?1:0);
				z('{$nakl_list_item.h_tp_kod_data_nakl}','{$nakl_list_item.summshok}','{$nakl_list_item.summvespech}');
				"
				type=checkbox
				{if $nakl_list_item.selected_if1 eq 1}checked{/if}
			>
			<input
				type=hidden
				id=if1{$nakl_list_item.h_tp_kod_data_nakl}
				name=data[{$nakl_list_item.h_tp_kod_data_nakl}][if1]
				{if $nakl_list_item.if1 neq 1} disabled {/if}
			>
			<script>$('#if1{$nakl_list_item.h_tp_kod_data_nakl}').val({$nakl_list_item.selected_if1});</script>

		</td>
		<td {if $nakl_list_item.if2 eq 1}bgcolor="#00ff00"{/if}  style="text-align:center">
			<input
				{if not $nakl_list_item.ok_traid neq 1 or $nakl_list_item.ok_chief eq 1}disabled{/if} {if $nakl_list_item.if2 neq 1} disabled {/if}
				onclick="
				$('#bonus_sum{$nakl_list_item.h_tp_kod_data_nakl}').attr('disabled',((!this.checked)&&(!($('#if1{$nakl_list_item.h_tp_kod_data_nakl}').val()==1)?true:false)));
				$('#bonus_dt{$nakl_list_item.h_tp_kod_data_nakl}').attr('disabled',((!this.checked)&&(!($('#if1{$nakl_list_item.h_tp_kod_data_nakl}').val()==1)?true:false)));
				$('#if2{$nakl_list_item.h_tp_kod_data_nakl}').val(this.checked?1:0);
				z('{$nakl_list_item.h_tp_kod_data_nakl}','{$nakl_list_item.summshok}','{$nakl_list_item.summvespech}');
				"
				type=checkbox
				{if $nakl_list_item.selected_if2 eq 1}checked{/if}
			>
			<input
				type=hidden
				id=if2{$nakl_list_item.h_tp_kod_data_nakl}
				name=data[{$nakl_list_item.h_tp_kod_data_nakl}][if2]
				{if $nakl_list_item.if2 neq 1} disabled {/if}
			>
			<script>$('#if2{$nakl_list_item.h_tp_kod_data_nakl}').val({$nakl_list_item.selected_if2});</script>
		</td>
		<td style="text-align:center">
			<input required
				{if $nakl_list_item.ok_chief eq 1 or ($nakl_list_item.selected_if1 neq 1 and $nakl_list_item.selected_if2 neq 1)}disabled{/if}
				class="number"
				size=10
				name=data[{$nakl_list_item.h_tp_kod_data_nakl}][bonus_sum] id=bonus_sum{$nakl_list_item.h_tp_kod_data_nakl} value="{$nakl_list_item.bonus_sum}"
				onchange="z('{$nakl_list_item.h_tp_kod_data_nakl}','{$nakl_list_item.summshok}','{$nakl_list_item.summvespech}');"
			>
		</td>
		<td style="text-align:center">
			<input required
				{if $nakl_list_item.ok_chief eq 1 or ($nakl_list_item.selected_if1 neq 1 and $nakl_list_item.selected_if2 neq 1)}disabled{/if}
				class="datepicker"
				size=10
				name=data[{$nakl_list_item.h_tp_kod_data_nakl}][bonus_dt] id=bonus_dt{$nakl_list_item.h_tp_kod_data_nakl} value="{$nakl_list_item.bonus_dt}"
			>
		</td>
		{if $nakl_list_item.if1 eq 1 or $nakl_list_item.if2 eq 1}
		<input type=hidden class=checker id=checker_{$nakl_list_item.h_tp_kod_data_nakl} value=0>
		{/if}
		<input
			type=hidden
			id=selected{$nakl_list_item.h_tp_kod_data_nakl}
			name=keys[{$nakl_list_item.h_tp_kod_data_nakl}]
		>
	</tr>
	{/foreach}
</table>

{literal}
<script>
function z(id,summshok,summvespech)
{
	$('#if1'+id).val()==1 ? x1 = $('#bonus_sum'+id).val() / summshok : x1 = 0;
	$('#if2'+id).val()==1 ? x2 = $('#bonus_sum'+id).val() / summvespech : x2 = 0;
	if (x1>=0.15||x2>=0.155)
	{
		alert('Накладная не может быть добавлена, так как превышена затратная часть!');
		$('#checker_'+id).attr('disabled',true);
	}
	else
	{
		$('#checker_'+id).attr('disabled',false);
	}
	$('.checker:disabled').length!=0 ? $('#add').attr('disabled',true) : $('#add').attr('disabled',false);

}
</script>
{/literal}


<p>
<input type=submit name=add id=add value="Добавить накладные в акцию">
</p>

